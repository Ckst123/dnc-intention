<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dnc-intention: dnc.memory.Memory Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">dnc-intention
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">여기에 개요를 입력</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classdnc_1_1memory_1_1_memory.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classdnc_1_1memory_1_1_memory-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dnc.memory.Memory Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae1abe8030593af667aa82b04f87ffd69"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#ae1abe8030593af667aa82b04f87ffd69">__init__</a> (self, words_num=256, word_size=64, read_heads=4, batch_size=1)</td></tr>
<tr class="separator:ae1abe8030593af667aa82b04f87ffd69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60939735f05f045ac75cad19280afaf"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#af60939735f05f045ac75cad19280afaf">get_lookup_weighting</a> (self, memory_matrix, keys, strengths)</td></tr>
<tr class="separator:af60939735f05f045ac75cad19280afaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ce6234c0a69e198a58cffa0d256bb67"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#a6ce6234c0a69e198a58cffa0d256bb67">update_usage_vector</a> (self, usage_vector, read_weightings, write_weighting, free_gates)</td></tr>
<tr class="separator:a6ce6234c0a69e198a58cffa0d256bb67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6153ecb850b007bd35668ecff657befc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#a6153ecb850b007bd35668ecff657befc">get_allocation_weighting</a> (self, sorted_usage, free_list)</td></tr>
<tr class="separator:a6153ecb850b007bd35668ecff657befc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1eb17cb7b7f7a14edbd21ce56819aff"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#ae1eb17cb7b7f7a14edbd21ce56819aff">update_write_weighting</a> (self, lookup_weighting, allocation_weighting, write_gate, allocation_gate)</td></tr>
<tr class="separator:ae1eb17cb7b7f7a14edbd21ce56819aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb03bc2cc825f4228adae03deba1f3ef"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#aeb03bc2cc825f4228adae03deba1f3ef">update_memory</a> (self, memory_matrix, write_weighting, write_vector, erase_vector)</td></tr>
<tr class="separator:aeb03bc2cc825f4228adae03deba1f3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace43cbe5ea257e4574fa411bebd40229"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#ace43cbe5ea257e4574fa411bebd40229">update_precedence_vector</a> (self, precedence_vector, write_weighting)</td></tr>
<tr class="separator:ace43cbe5ea257e4574fa411bebd40229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2454b8d063fee27175136ae618597d0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#ac2454b8d063fee27175136ae618597d0">update_link_matrix</a> (self, precedence_vector, link_matrix, write_weighting)</td></tr>
<tr class="separator:ac2454b8d063fee27175136ae618597d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3116d5f908e2b27e11021d7efcfbb4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#a6d3116d5f908e2b27e11021d7efcfbb4">get_directional_weightings</a> (self, read_weightings, link_matrix)</td></tr>
<tr class="separator:a6d3116d5f908e2b27e11021d7efcfbb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0801ff26c19cbefc29040c6d44dd557"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#ab0801ff26c19cbefc29040c6d44dd557">update_read_weightings</a> (self, lookup_weightings, forward_weighting, backward_weighting, read_mode)</td></tr>
<tr class="separator:ab0801ff26c19cbefc29040c6d44dd557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a97de80262c6155f50bfaca1e63fb60"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#a9a97de80262c6155f50bfaca1e63fb60">update_read_vectors</a> (self, memory_matrix, read_weightings)</td></tr>
<tr class="separator:a9a97de80262c6155f50bfaca1e63fb60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00697bd0c79f2c7275ec899cb43114c0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#a00697bd0c79f2c7275ec899cb43114c0">write</a> (self, memory_matrix, usage_vector, read_weightings, write_weighting, precedence_vector, link_matrix, key, strength, free_gates, allocation_gate, write_gate, write_vector, erase_vector)</td></tr>
<tr class="separator:a00697bd0c79f2c7275ec899cb43114c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83735c28400f1f2b381152450d2f0d02"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdnc_1_1memory_1_1_memory.html#a83735c28400f1f2b381152450d2f0d02">read</a> (self, memory_matrix, read_weightings, keys, strengths, link_matrix, read_modes)</td></tr>
<tr class="separator:a83735c28400f1f2b381152450d2f0d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a09475965c5dbf8863edac69db5fcd6ca"><td class="memItemLeft" align="right" valign="top"><a id="a09475965c5dbf8863edac69db5fcd6ca"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>words_num</b></td></tr>
<tr class="separator:a09475965c5dbf8863edac69db5fcd6ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc3aeb5050824e4851360c7a181d0abe"><td class="memItemLeft" align="right" valign="top"><a id="acc3aeb5050824e4851360c7a181d0abe"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>word_size</b></td></tr>
<tr class="separator:acc3aeb5050824e4851360c7a181d0abe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5860a04d31e0245da444b6174df9a62f"><td class="memItemLeft" align="right" valign="top"><a id="a5860a04d31e0245da444b6174df9a62f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>read_heads</b></td></tr>
<tr class="separator:a5860a04d31e0245da444b6174df9a62f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a497d7b28c6da14fab3e1e692bb211736"><td class="memItemLeft" align="right" valign="top"><a id="a497d7b28c6da14fab3e1e692bb211736"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>batch_size</b></td></tr>
<tr class="separator:a497d7b28c6da14fab3e1e692bb211736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6efb7c5a763d5dcb5c36b63d9cb1f9bf"><td class="memItemLeft" align="right" valign="top"><a id="a6efb7c5a763d5dcb5c36b63d9cb1f9bf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>I</b></td></tr>
<tr class="separator:a6efb7c5a763d5dcb5c36b63d9cb1f9bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f631839fb7fe8dcec5a795c8d16833"><td class="memItemLeft" align="right" valign="top"><a id="a24f631839fb7fe8dcec5a795c8d16833"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>index_mapper</b></td></tr>
<tr class="separator:a24f631839fb7fe8dcec5a795c8d16833"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae1abe8030593af667aa82b04f87ffd69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1abe8030593af667aa82b04f87ffd69">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>words_num</em> = <code>256</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>word_size</em> = <code>64</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_heads</em> = <code>4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch_size</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">constructs a memory matrix with read heads and a write head as described
in the DNC paper
http://www.nature.com/nature/journal/vaop/ncurrent/full/nature20101.html

Parameters:
----------
words_num: int
    the maximum number of words that can be stored in the memory at the
    same time
word_size: int
    the size of the individual word in the memory
read_heads: int
    the number of read heads that can read simultaneously from the memory
batch_size: int
    the size of input data batch
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6153ecb850b007bd35668ecff657befc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6153ecb850b007bd35668ecff657befc">&#9670;&nbsp;</a></span>get_allocation_weighting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.get_allocation_weighting </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sorted_usage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>free_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">retreives the writing allocation weighting based on the usage free list

Parameters:
----------
sorted_usage: Tensor (batch_size, words_num, )
    the usage vector sorted ascndingly
free_list: Tensor (batch, words_num, )
    the original indecies of the sorted usage vector

Returns: Tensor (batch_size, words_num, )
    the allocation weighting for each word in memory
</pre> 
</div>
</div>
<a id="a6d3116d5f908e2b27e11021d7efcfbb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d3116d5f908e2b27e11021d7efcfbb4">&#9670;&nbsp;</a></span>get_directional_weightings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.get_directional_weightings </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_weightings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>link_matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">computes and returns the forward and backward reading weightings
given the read_weightings from the previous step

Parameters:
----------
read_weightings: Tensor (batch_size, words_num, read_heads)
    the read weightings from the last time step
link_matrix: Tensor (batch_size, words_num, words_num)
    the temporal link matrix

Returns: Tuple
    forward weighting: Tensor (batch_size, words_num, read_heads),
    backward weighting: Tensor (batch_size, words_num, read_heads)
</pre> 
</div>
</div>
<a id="af60939735f05f045ac75cad19280afaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af60939735f05f045ac75cad19280afaf">&#9670;&nbsp;</a></span>get_lookup_weighting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.get_lookup_weighting </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>memory_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>strengths</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">retrives a content-based adderssing weighting given the keys

Parameters:
----------
memory_matrix: Tensor (batch_size, words_num, word_size)
    the memory matrix to lookup in
keys: Tensor (batch_size, word_size, number_of_keys)
    the keys to query the memory with
strengths: Tensor (batch_size, number_of_keys, )
    the list of strengths for each lookup key

Returns: Tensor (batch_size, words_num, number_of_keys)
    The list of lookup weightings for each provided key
</pre> 
</div>
</div>
<a id="a83735c28400f1f2b381152450d2f0d02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83735c28400f1f2b381152450d2f0d02">&#9670;&nbsp;</a></span>read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.read </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>memory_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_weightings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>strengths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>link_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_modes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">defines the complete pipeline for reading from memory

Parameters:
----------
memory_matrix: Tensor (batch_size, words_num, word_size)
    the updated memory matrix from the last writing
read_weightings: Tensor (batch_size, words_num, read_heads)
    the read weightings form the last time step
keys: Tensor (batch_size, word_size, read_heads)
    the kyes to query the memory locations with
strengths: Tensor (batch_size, read_heads)
    the strength of each read key
link_matrix: Tensor (batch_size, words_num, words_num)
    the updated link matrix from the last writing
read_modes: Tensor (batch_size, 3, read_heads)
    the softmax distribution between the three read modes

Returns: Tuple
    the updated read_weightings: Tensor(batch_size, words_num, read_heads)
    the recently read vectors: Tensor (batch_size, word_size, read_heads)
</pre> 
</div>
</div>
<a id="ac2454b8d063fee27175136ae618597d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2454b8d063fee27175136ae618597d0">&#9670;&nbsp;</a></span>update_link_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.update_link_matrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precedence_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>link_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_weighting</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">updates and returns the temporal link matrix for the latest write
given the precedence vector and the link matrix from previous step

Parameters:
----------
precedence_vector: Tensor (batch_size, words_num)
    the precedence vector from the last time step
link_matrix: Tensor (batch_size, words_num, words_num)
    the link matrix form the last step
write_weighting: Tensor (batch_size, words_num)
    the latest write_weighting for the memory

Returns: Tensor (batch_size, words_num, words_num)
    the updated temporal link matrix
</pre> 
</div>
</div>
<a id="aeb03bc2cc825f4228adae03deba1f3ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb03bc2cc825f4228adae03deba1f3ef">&#9670;&nbsp;</a></span>update_memory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.update_memory </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>memory_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_weighting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>erase_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">updates and returns the memory matrix given the weighting, write and erase vectors
and the memory matrix from previous step

Parameters:
----------
memory_matrix: Tensor (batch_size, words_num, word_size)
    the memory matrix from previous step
write_weighting: Tensor (batch_size, words_num)
    the weight of writing at each memory location
write_vector: Tensor (batch_size, word_size)
    a vector specifying what to write
erase_vector: Tensor (batch_size, word_size)
    a vector specifying what to erase from memory

Returns: Tensor (batch_size, words_num, word_size)
    the updated memory matrix
</pre> 
</div>
</div>
<a id="ace43cbe5ea257e4574fa411bebd40229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace43cbe5ea257e4574fa411bebd40229">&#9670;&nbsp;</a></span>update_precedence_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.update_precedence_vector </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precedence_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_weighting</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">updates the precedence vector given the latest write weighting
and the precedence_vector from last step

Parameters:
----------
precedence_vector: Tensor (batch_size. words_num)
    the precedence vector from the last time step
write_weighting: Tensor (batch_size,words_num)
    the latest write weighting for the memory

Returns: Tensor (batch_size, words_num)
    the updated precedence vector
</pre> 
</div>
</div>
<a id="a9a97de80262c6155f50bfaca1e63fb60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a97de80262c6155f50bfaca1e63fb60">&#9670;&nbsp;</a></span>update_read_vectors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.update_read_vectors </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>memory_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_weightings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">reads, updates, and returns the read vectors of the recently updated memory

Parameters:
----------
memory_matrix: Tensor (batch_size, words_num, word_size)
    the recently updated memory matrix
read_weightings: Tensor (batch_size, words_num, read_heads)
    the amount of info to read from each memory location by each read head

Returns: Tensor (word_size, read_heads)
</pre> 
</div>
</div>
<a id="ab0801ff26c19cbefc29040c6d44dd557"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0801ff26c19cbefc29040c6d44dd557">&#9670;&nbsp;</a></span>update_read_weightings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.update_read_weightings </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lookup_weightings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>forward_weighting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>backward_weighting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">updates and returns the current read_weightings

Parameters:
----------
lookup_weightings: Tensor (batch_size, words_num, read_heads)
    the content-based read weighting
forward_weighting: Tensor (batch_size, words_num, read_heads)
    the forward direction read weighting
backward_weighting: Tensor (batch_size, words_num, read_heads)
    the backward direction read weighting
read_mode: Tesnor (batch_size, 3, read_heads)
    the softmax distribution between the three read modes

Returns: Tensor (batch_size, words_num, read_heads)
</pre> 
</div>
</div>
<a id="a6ce6234c0a69e198a58cffa0d256bb67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ce6234c0a69e198a58cffa0d256bb67">&#9670;&nbsp;</a></span>update_usage_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.update_usage_vector </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>usage_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_weightings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_weighting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>free_gates</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">updates and returns the usgae vector given the values of the free gates
and the usage_vector, read_weightings, write_weighting from previous step

Parameters:
----------
usage_vector: Tensor (batch_size, words_num)
read_weightings: Tensor (batch_size, words_num, read_heads)
write_weighting: Tensor (batch_size, words_num)
free_gates: Tensor (batch_size, read_heads, )

Returns: Tensor (batch_size, words_num, )
    the updated usage vector
</pre> 
</div>
</div>
<a id="ae1eb17cb7b7f7a14edbd21ce56819aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1eb17cb7b7f7a14edbd21ce56819aff">&#9670;&nbsp;</a></span>update_write_weighting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.update_write_weighting </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lookup_weighting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>allocation_weighting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>allocation_gate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">updates and returns the current write_weighting

Parameters:
----------
lookup_weighting: Tensor (batch_size, words_num, 1)
    the weight of the lookup operation in writing
allocation_weighting: Tensor (batch_size, words_num)
    the weight of the allocation operation in writing
write_gate: (batch_size, 1)
    the fraction of writing to be done
allocation_gate: (batch_size, 1)
    the fraction of allocation to be done

Returns: Tensor (batch_size, words_num)
    the updated write_weighting
</pre> 
</div>
</div>
<a id="a00697bd0c79f2c7275ec899cb43114c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00697bd0c79f2c7275ec899cb43114c0">&#9670;&nbsp;</a></span>write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def dnc.memory.Memory.write </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>memory_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>usage_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>read_weightings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_weighting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precedence_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>link_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>strength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>free_gates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>allocation_gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_gate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>write_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>erase_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">defines the complete pipeline of writing to memory gievn the write variables
and the memory_matrix, usage_vector, link_matrix, and precedence_vector from
previous step

Parameters:
----------
memory_matrix: Tensor (batch_size, words_num, word_size)
    the memory matrix from previous step
usage_vector: Tensor (batch_size, words_num)
    the usage_vector from the last time step
read_weightings: Tensor (batch_size, words_num, read_heads)
    the read_weightings from the last time step
write_weighting: Tensor (batch_size, words_num)
    the write_weighting from the last time step
precedence_vector: Tensor (batch_size, words_num)
    the precedence vector from the last time step
link_matrix: Tensor (batch_size, words_num, words_num)
    the link_matrix from previous step
key: Tensor (batch_size, word_size, 1)
    the key to query the memory location with
strength: (batch_size, 1)
    the strength of the query key
free_gates: Tensor (batch_size, read_heads)
    the degree to which location at read haeds will be freed
allocation_gate: (batch_size, 1)
    the fraction of writing that is being allocated in a new locatio
write_gate: (batch_size, 1)
    the amount of information to be written to memory
write_vector: Tensor (batch_size, word_size)
    specifications of what to write to memory
erase_vector: Tensor(batch_size, word_size)
    specifications of what to erase from memory

Returns : Tuple
    the updated usage vector: Tensor (batch_size, words_num)
    the updated write_weighting: Tensor(batch_size, words_num)
    the updated memory_matrix: Tensor (batch_size, words_num, words_size)
    the updated link matrix: Tensor(batch_size, words_num, words_num)
    the updated precedence vector: Tensor (batch_size, words_num)
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>dnc/memory.py</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>dnc</b></li><li class="navelem"><b>memory</b></li><li class="navelem"><a class="el" href="classdnc_1_1memory_1_1_memory.html">Memory</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
